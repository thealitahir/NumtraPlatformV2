<app-header></app-header>

<!--
  <main>

    <div *ngIf="ml_status == 1">

       <div *ngFor='let mresult of modelresult' fxLayout="row" fxLayoutGap="20px">
        <h2 fxFlex="50%" fxLayoutAlign="center center">{{mresult.modelname}}</h2>
      </div>

      <div class="container">

        <div *ngFor='let mresult of modelresult' fxLayout="row" fxLayoutGap="5px">

          <div class="box" fxLayout fxLayoutAlign="space-between center" style="text-align: center;">
            <div fxFlex="50%">
              <h3>Best Model : {{mresult.Best_Model}}</h3>
            </div>
            <div fxLayout="column" fxFlex="50%" style="text-align: center;">
              <easy-pie-chart [options]="{animate: 2000, lineWidth: 12, size: 150, barColor: '#009688', trackColor: 'rgba(0, 150, 136, 0.2)'}"
                [percent]=mresult.Accuracy></easy-pie-chart>
              <label>Accuracy {{mresult.Accuracy}}%</label>
            </div>
          </div>

          <div class="box" fxLayout fxLayoutAlign="space-between center">
            <label fxFlex="25%">F1 {{mresult.F1}}%</label>
            <mat-progress-bar fxFlex="50%" mode="determinate" value="{{mresult.F1}}"></mat-progress-bar>
          </div>


          <div class="box" fxLayout fxLayoutAlign="space-between center">
            <label fxFlex="25%">Precision {{mresult.Precision}}%</label>
            <mat-progress-bar fxFlex="50%" mode="determinate" value="{{mresult.Precision}}"></mat-progress-bar>
          </div>

          <div class="box" fxLayout fxLayoutAlign="space-between center">
            <label fxFlex="25%">Recall {{mresult.Recall}}%</label>
            <mat-progress-bar fxFlex="50%" mode="determinate" value="{{mresult.Recall}}"></mat-progress-bar>
          </div>


          <table class="table">
            <thead>
              <th>List of models</th>
            </thead>
            <tbody *ngFor='let modresult of mresult.List_of_all_models'>
              <tr>
                <td>{{modresult}}</td>
              </tr>
            </tbody>

          </table>

          <div class="box" fxLayout="row" fxLayoutAlign="center center">

            <div class="table-left-heading">Predictor</div>

            <div fxLayout="column">
              <div class="table-top-heading">Actual</div>

              <table class="table">

                <tr>
                  <td></td>
                  <td class="positive">Positive</td>
                  <td class="negative">Negative</td>
                </tr>

                <tr>
                  <td class="positive">Positive</td>
                  <td class="true">
                    True Positive
                    <br>
                    {{mresult.true_positive}}
                  </td>
                  <td class="false">
                    False Positive
                    <br>
                    {{mresult.false_positive}}
                  </td>
                </tr>

                <tr>
                  <td class="negative">Negative</td>
                  <td class="false">
                    False Negative
                    <br>
                    {{mresult.False_negative}}
                  </td>
                  <td class="true">
                    True Negative
                    <br>
                    {{mresult.true_negative}}
                  </td>
                </tr>

              </table>
            </div>

          </div>



        </div>

      </div>
    </div>
  </main>
-->

<main>
  <div
    *ngIf="(ml_status == 0 || loader == 1) && execution_status == 0"
    class="loader-gloabl"
  >
    <mat-spinner></mat-spinner>
    <div style="z-index: 9999; text-align: center; margin-top: 100px">
      <div class="loading-message">Data is processing. Please wait!</div>
    </div>
  </div>

  <!-- <div *ngIf="execution_status == 1 && ml_status !== 1 "> -->

  <div fxFlex="row" *ngIf="execution_status == 1 && ml_status !== 1">
    <div fxFlex="60">
      <table class="model-logs-table" [innerHTML]="execution_result"></table>
    </div>

    <div fxFlex="40">
      <h3>Best Model</h3>

      <div class="box" fxLayout>
        <div fxLayout="column" fxFlex="50" fxLayoutAlign="center start">

          <div>
            Generation: <br />
            <strong>{{ bestModelGeneration }}</strong>
          </div>
          <br />
          <div>
            Name: <br />
            <strong>{{ bestModelName }}</strong>
          </div>
          <br />
          <div>
              Steps: <br />
              <strong>{{ bestModelFeatureTrasformation }}</strong>
          </div>
        </div>

        <div fxFlex="50" style="text-align: center;">
          <easy-pie-chart
            [options]="{
              animate: 2000,
              lineWidth: 12,
              size: 150,
              barColor: '#009688',
              trackColor: 'rgba(0, 150, 136, 0.2)'
            }"
            [percent]="bestModelAccuracy"
          ></easy-pie-chart>

          <div>
            Accuracy: <strong>{{ bestModelAccuracy }}%</strong>
          </div>
        </div>
      </div>

      <h3>Visualization</h3>
      <div class="box model-logs-graph-wrap">
        <div class="model-logs-graph">
          <ngx-charts-line-chart
            [scheme]="colorScheme"
            [results]="lineGraphData"
            [gradient]="gradient"
            [xAxis]="showXAxis"
            [yAxis]="showYAxis"
            [legend]="showLegend"
            [showXAxisLabel]="showXAxisLabel"
            [showYAxisLabel]="showYAxisLabel"
            [xAxisLabel]="xAxisLabel"
            [yAxisLabel]="yAxisLabel"
            [autoScale]="autoScale"
            (select)="onSelect($event)"
          >
          </ngx-charts-line-chart>
        </div>
      </div>
    </div>
  </div>


    <div class="result-view" *ngIf="ml_status == 1 && loader == 0">
      <div *ngFor='let mresult of modelresult'>
        <h2>{{mresult.modelname}}</h2>
      </div>

      <div *ngFor='let mresult of modelresult' fxLayout="row">

        <div fxFlex="20" class="left-col">
          <ul>
            <li *ngFor='let modresult of mresult.List_of_all_models'>
              {{modresult.model_name}}: {{modresult.accuracy}}%
            </li>
          </ul>
        </div>

        <div class="right-col" fxFlex="80">

          <div fxLayout="row" fxLayoutGap="20px">
            <div class="box" fxLayout fxLayoutAlign="space-between center" style="text-align: center;">
              <div fxFlex="50">
                <h3>Best Model : {{mresult.Best_Model}}</h3>
              </div>
              <div fxLayout="column" fxFlex="50%" style="text-align: center;" *ngIf="mresult.Accuracy">
                <easy-pie-chart [options]="{animate: 2000, lineWidth: 12, size: 150, barColor: '#009688', trackColor: 'rgba(0, 150, 136, 0.2)'}"
                  [percent]=mresult.Accuracy></easy-pie-chart>
                <label>Accuracy: {{mresult.Accuracy}}%</label>
              </div>
              <div fxLayout="column" fxFlex="50%" style="text-align: center;" *ngIf="mresult.Error_rate">
                <easy-pie-chart [options]="{animate: 2000, lineWidth: 12, size: 150, barColor: '#009688', trackColor: 'rgba(0, 150, 136, 0.2)'}"
                  [percent]=mresult.Error_rate></easy-pie-chart>
                <label>Error Rate: {{mresult.Error_rate}}%</label>
              </div>
            </div>

            <div class="box" fxLayout="row" fxLayoutAlign="center center" *ngIf="data_type !== 'regression'">

              <div class="table-left-heading">Predictor</div>

              <div fxLayout="column">
                <div class="table-top-heading">Actual</div>

                <table class="table">

                  <tr>
                    <td></td>
                    <td class="positive">Positive</td>
                    <td class="negative">Negative</td>
                  </tr>

                  <tr>
                    <td class="positive">Positive</td>
                    <td class="true">
                      True Positive
                      <br>
                      {{mresult.true_positive}}
                    </td>
                    <td class="false">
                      False Positive
                      <br>
                      {{mresult.false_positive}}
                    </td>
                  </tr>

                  <tr>
                    <td class="negative">Negative</td>
                    <td class="false">
                      False Negative
                      <br>
                      {{mresult.False_negative}}
                    </td>
                    <td class="true">
                      True Negative
                      <br>
                      {{mresult.true_negative}}
                    </td>
                  </tr>

                </table>
              </div>
            </div>
          </div>

          <div class="box" fxLayout="column" *ngIf="data_type == 'classification'">

            <div class="box-row" fxLayout fxLayoutAlign="space-between center">
              <label fxFlex="25">F1: {{mresult.F1}}%</label>
              <mat-progress-bar fxFlex="50%" mode="determinate" value="{{mresult.F1}}"></mat-progress-bar>
            </div>

            <div class="box-row" fxLayout fxLayoutAlign="space-between center">
              <label fxFlex="25%">Precision: {{mresult.Precision}}%</label>
              <mat-progress-bar fxFlex="50%" mode="determinate" value="{{mresult.Precision}}"></mat-progress-bar>
            </div>

            <div class="box-row" fxLayout fxLayoutAlign="space-between center">
              <label fxFlex="25%">Recall: {{mresult.Recall}}%</label>
              <mat-progress-bar fxFlex="50%" mode="determinate" value="{{mresult.Recall}}"></mat-progress-bar>
            </div>

          </div>
          <div class="box" fxLayout="column" *ngIf="data_type == 'regression'">

            <div class="box-row" fxLayout fxLayoutAlign="space-between center">
              <label fxFlex="25">R2: {{mresult.R2}}%</label>
              <mat-progress-bar fxFlex="50%" mode="determinate" value="{{mresult.R2}}"></mat-progress-bar>
            </div>

            <div class="box-row" fxLayout fxLayoutAlign="space-between center">
              <label fxFlex="25%">Mean Squared Error: {{mresult.Mean_Squared_Error}}%</label>
              <mat-progress-bar fxFlex="50%" mode="determinate" value="{{mresult.Mean_Squared_Error}}"></mat-progress-bar>
            </div>

            <div class="box-row" fxLayout fxLayoutAlign="space-between center">
              <label fxFlex="25%">Mean Absolute Error: {{mresult.Mean_Absolute_Error}}%</label>
              <mat-progress-bar fxFlex="50%" mode="determinate" value="{{mresult.Mean_Absolute_Error}}"></mat-progress-bar>
            </div>

            <div class="box-row" fxLayout fxLayoutAlign="space-between center">
              <label fxFlex="25%">Median Absolute Error: {{mresult.Median_Absolute_Error}}%</label>
              <mat-progress-bar fxFlex="50%" mode="determinate" value="{{mresult.Median_Absolute_Error}}"></mat-progress-bar>
            </div>

          </div>

        </div>
      </div>

    </div>

</main>
